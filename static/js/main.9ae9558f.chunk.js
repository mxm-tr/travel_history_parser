(this["webpackJsonptravel-history-parser"]=this["webpackJsonptravel-history-parser"]||[]).push([[0],{445:function(e,t){},466:function(e,t,a){},504:function(e,t,a){e.exports=a(777)},594:function(e,t,a){},705:function(e,t,a){},711:function(e,t){},712:function(e,t){},777:function(e,t,a){"use strict";a.r(t);var n=a(112),r=a(113),o=a(64),l=a(116),i=a(115),c=a(0),s=a.n(c),u=a(17),d=a.n(u),m=a(30),h=a.n(m),p=a(132),f=a(780),E=a(784),g=a(813),w=a(816),b=a(817),v=a(802),y=a(55),C=a(473),S=a.n(C),k=a(265),O=a.n(k),D=a(264),W=a.n(D),x=(a(594),a(497)),j=a(316),R=a(22),I=a(805),T=a(806),M=a(244),P=a(803),N=a(341),A=a(818),F=a(804),U=a(315);function Y(e){var t=e.children,a=e.value,n=e.index,r=Object(x.a)(e,["children","value","index"]);return s.a.createElement(y.a,Object.assign({component:"div",role:"tabpanel",hidden:a!==n,id:"scrollable-force-tabpanel-".concat(n),"aria-labelledby":"scrollable-force-tab-".concat(n)},r),a===n&&s.a.createElement(U.a,{p:3},t))}function H(e){return{id:"scrollable-force-tab-".concat(e),"aria-controls":"scrollable-force-tabpanel-".concat(e)}}var L=function(e){Object(l.a)(a,e);var t=Object(i.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={tabValue:0},r.handleTabChange=r.handleTabChange.bind(Object(o.a)(r)),r.selectYear=r.selectYear.bind(Object(o.a)(r)),r}return Object(r.a)(a,[{key:"handleTabChange",value:function(e,t){switch(this.setState({tabValue:t}),t){case 0:this.props.handleWindowStartChange(this.props.dateWindowStart),this.props.handleWindowStopChange(this.props.dateWindowStop);break;case 1:this.selectYear(h()(this.props.dateWindowStart)._d)}}},{key:"selectYear",value:function(e){this.props.handleWindowStartChange(h()(new Date("01/01/"+e.getFullYear()))),this.props.handleWindowStopChange(h()(new Date("12/31/"+e.getFullYear())))}},{key:"render",value:function(){var e=this,t=this.props;return s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(R.a,{utils:M.default},s.a.createElement(P.a,{position:"static"},s.a.createElement(N.a,null,s.a.createElement(y.a,{variant:"h6",className:t.title},s.a.createElement("span",{role:"img","aria-label":"tooltip-calendar-title"},"\ud83d\udcc5")," Select counting period")),s.a.createElement(A.a,{value:this.state.tabValue,onChange:this.handleTabChange,"aria-label":"Counting period"},s.a.createElement(F.a,Object.assign({label:"Custom dates"},H(0))),s.a.createElement(F.a,Object.assign({label:"One Year"},H(1))),s.a.createElement(F.a,Object.assign({label:"Whole travel history"},H(2))))),s.a.createElement(I.a,{className:t.root},s.a.createElement(T.a,null,s.a.createElement(Y,{value:this.state.tabValue,index:0},s.a.createElement(y.a,{className:t.title,component:"h1"},"Count travel days on a specific period"),s.a.createElement(j.a,{variant:"dialog",id:"dateWindowStart",label:"From",format:"yyyy-MM-dd",value:this.props.dateWindowStart,onChange:function(t){return e.props.handleWindowStartChange(h()(t))}}),s.a.createElement(j.a,{variant:"dialog",id:"dateWindowStop",label:"To",format:"yyyy-MM-dd",value:this.props.dateWindowStop,onChange:function(t){return e.props.handleWindowStopChange(h()(t))}}),s.a.createElement(y.a,{component:"p",color:"textSecondary"},"The total of days will be counted between the given dates.")),s.a.createElement(Y,{value:this.state.tabValue,index:1},s.a.createElement(y.a,{className:t.title,component:"h1"},"Count travel days in a full year"),s.a.createElement(j.a,{views:["year"],label:"Year long period",value:this.props.dateWindowStart,onChange:this.selectYear}),s.a.createElement(y.a,{component:"p",color:"textSecondary"},"The total of days will be counted for the given year.")),s.a.createElement(Y,{value:this.state.tabValue,index:2},s.a.createElement(U.a,null,s.a.createElement(p.a,{onClick:this.props.fitDateWindow,variant:"contained",color:"primary",size:"medium"},"Select whole travel history")),s.a.createElement(y.a,{component:"p",color:"textSecondary"},"The total of days will be counted for the whole travel history list."))))))}}]),a}(s.a.Component),z=a(475),V=a.n(z),B=(a(705),a(790)),_=a(808),J=a(792),q=a(807),G=a(476),$=a.n(G),K=a(479),Q=a.n(K),X=a(478),Z=a.n(X),ee=a(262),te=a.n(ee),ae=a(470),ne=a(446),re=a(447),oe=a(449),le=a(809),ie=a(448),ce=a(130),se=a(354),ue=a(347),de=a.n(ue),me=a(477),he=a.n(me),pe=2,fe=1;function Ee(e){var t=Array.from(e);return t.sort((function(e,t){return h()(e.date)-h()(t.date)})),t}function ge(e){var t=e.filter((function(e){return e.group===fe}));return t.length<1?0:t.map((function(e){return e.durationDateWindow})).reduce((function(e,t){return e+t}),0)}function we(e){if(void 0!==e)return new h.a(e)}function be(e){return h()(e).format("YYYY-MM-DD")}function ve(e,t,a,n){var r=we(e),o=we(t),l=we(a),i=we(n);return void 0===a||void 0===n?Math.abs(o.diff(r,"days"))+1:r>=i||o<=l?0:h.a.min(i,o).diff(h.a.max(l,r),"days")+1}function ye(e,t){var a={Sheets:{data:de.a.utils.json_to_sheet(t)},SheetNames:["data"]},n=de.a.write(a,{bookType:"xlsx",type:"array"}),r=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});he.a.saveAs(r,"dataExport.xlsx")}var Ce=Object(se.a)((function(){return{chip:{margin:"0px 5px 0px 5px"},errorMessage:{fontSize:"0.8rem"}}}));function Se(e,t){return s.a.createElement(ae.a,{icon:"DEP"===e.type?s.a.createElement(Z.a,null):s.a.createElement(te.a,null),className:t?t.chip:"",label:"".concat(be(e.date)," : ").concat(e.location)})}function ke(e,t){return s.a.createElement(B.a,{variant:"body2"},e.map((function(e,a){return function(e,t,a){var n=s.a.createElement(y.a,{className:a.errorMessage,color:"textPrimary",gutterBottom:!0},"and");return s.a.createElement(J.a,{key:t},s.a.createElement(q.a,null,s.a.createElement(Q.a,null)),s.a.createElement($.a,{separator:n},e.travelChecks.map((function(e){return Se(e,a)}))),s.a.createElement(y.a,{className:a.errorMessage,color:"textPrimary",gutterBottom:!0},e.message))}(e,a,t)})),s.a.createElement(_.a,null))}function Oe(e){var t=Ce(e);return void 0===e.errors||e.errors.length<1?"":s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(U.a,null,s.a.createElement(P.a,{position:"static"},s.a.createElement(N.a,null,s.a.createElement(y.a,{variant:"h6",className:t.title},"Errors"))),s.a.createElement(I.a,{className:t.root},ke(e.errors,t))))}function De(e){var t=Ce(e),a=s.a.createElement(T.a,null,s.a.createElement(le.a,{component:ce.a},s.a.createElement(ne.a,{className:t.table,"aria-label":"simple table"},s.a.createElement(re.a,null,s.a.createElement(ie.a,{key:"inside-count"},s.a.createElement(oe.a,{component:"th",scope:"row"},"Total days inside the US:"),s.a.createElement(oe.a,null),s.a.createElement(oe.a,{align:"right"},e.totalDaysInside)),s.a.createElement(ie.a,{key:"outside-count"},s.a.createElement(oe.a,{component:"th",scope:"row"},"Total days outside the US:"),s.a.createElement(oe.a,null),s.a.createElement(oe.a,{align:"right"},e.totalDaysOutside)),s.a.createElement(ie.a,{key:"window-count"},s.a.createElement(oe.a,{component:"th",scope:"row"},"Total days in window:"),s.a.createElement(oe.a,null),s.a.createElement(oe.a,{align:"right"},e.totalDaysWindow)),s.a.createElement(ie.a,{key:"window-period"},s.a.createElement(oe.a,{component:"th",scope:"row"},"Selected period"),s.a.createElement(oe.a,{align:"left"},"From ",be(e.dateWindowStart)),s.a.createElement(oe.a,{align:"left"},"To ",be(e.dateWindowStop)))))));return void 0!==e.errors&&e.errors.length>0&&(a=s.a.createElement(T.a,null,s.a.createElement(y.a,{className:t.title,color:"textSecondary",gutterBottom:!0},"Unable to calculate a result, please fix the ",e.totalErrors," errors and try again."))),s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(U.a,null,s.a.createElement(P.a,{position:"static"},s.a.createElement(N.a,null,s.a.createElement(y.a,{variant:"h6",className:t.title},s.a.createElement("span",{role:"img","aria-label":"tooltip-calc-title"},"\ud83e\uddee")," Results"))),s.a.createElement(I.a,{className:t.root},a)))}var We=function(e){Object(l.a)(a,e);var t=Object(i.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).timelineRef=s.a.createRef(),r}return Object(r.a)(a,[{key:"componentDidUpdate",value:function(){this.timelineRef.current&&this.timelineRef.current.$el.fit()}},{key:"render",value:function(){var e=this,t=this.props,a={width:"100%",stack:!0,showMajorLabels:!0,showCurrentTime:!1,zoomMin:1e6,type:"background",format:{minorLabels:{minute:"h:mma",hour:"ha"}},template:function(e,t,a){return void 0===e.travelCheck?"background"===e.type?"Selected period":"From ".concat(be(a.start)," to ").concat(be(a.end)):d.a.createPortal(d.a.render(s.a.createElement("div",null,Se(e.travelCheck)),t),t,(function(){window.timeline.redraw()}))}},n={id:this.props.travels.length+1,type:"background",start:this.props.dateWindowStart,end:this.props.dateWindowStop,content:""},r=this.props.travelChecks.map((function(t,a){return{id:e.props.travels.length+a+2,type:"point",title:"".concat(t.type," ").concat(t.location," : ").concat(t.date),content:"".concat(t.location," : ").concat(t.date),start:t.date,group:3,travelCheck:t}}));return s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(P.a,{position:"static"},s.a.createElement(N.a,null,s.a.createElement(y.a,{variant:"h6",className:t.title},s.a.createElement("span",{role:"img","aria-label":"tooltip-graph-title"},"\ud83d\udcca")," Timeline"))),s.a.createElement(V.a,{options:a,ref:this.timelineRef,groups:[{id:2,content:"Outside the US"},{id:1,content:"Inside the US"},{id:3,content:"Checks"}],items:this.props.travels.concat(r).concat(n)}))}}]),a}(s.a.PureComponent),xe=a(480),je=a.n(xe),Re=a(486),Ie=a.n(Re),Te=a(349),Me=a.n(Te),Pe=a(348),Ne=a.n(Pe),Ae=a(481),Fe=a.n(Ae),Ue=a(483),Ye=a.n(Ue),He=a(484),Le=a.n(He),ze=a(485),Ve=a.n(ze),Be=a(488),_e=a.n(Be),Je=a(482),qe=a.n(Je),Ge=a(487),$e=a.n(Ge),Ke=a(489),Qe=a.n(Ke),Xe={Add:Object(c.forwardRef)((function(e,t){return s.a.createElement(W.a,Object.assign({},e,{ref:t}))})),Check:Object(c.forwardRef)((function(e,t){return s.a.createElement(je.a,Object.assign({},e,{ref:t}))})),Clear:Object(c.forwardRef)((function(e,t){return s.a.createElement(Ne.a,Object.assign({},e,{ref:t}))})),Delete:Object(c.forwardRef)((function(e,t){return s.a.createElement(O.a,Object.assign({},e,{ref:t}))})),DetailPanel:Object(c.forwardRef)((function(e,t){return s.a.createElement(Me.a,Object.assign({},e,{ref:t}))})),Edit:Object(c.forwardRef)((function(e,t){return s.a.createElement(Fe.a,Object.assign({},e,{ref:t}))})),Export:Object(c.forwardRef)((function(e,t){return s.a.createElement(qe.a,Object.assign({},e,{ref:t}))})),Filter:Object(c.forwardRef)((function(e,t){return s.a.createElement(Ye.a,Object.assign({},e,{ref:t}))})),FirstPage:Object(c.forwardRef)((function(e,t){return s.a.createElement(Le.a,Object.assign({},e,{ref:t}))})),LastPage:Object(c.forwardRef)((function(e,t){return s.a.createElement(Ve.a,Object.assign({},e,{ref:t}))})),NextPage:Object(c.forwardRef)((function(e,t){return s.a.createElement(Me.a,Object.assign({},e,{ref:t}))})),PreviousPage:Object(c.forwardRef)((function(e,t){return s.a.createElement(Ie.a,Object.assign({},e,{ref:t}))})),ResetSearch:Object(c.forwardRef)((function(e,t){return s.a.createElement(Ne.a,Object.assign({},e,{ref:t}))})),Search:Object(c.forwardRef)((function(e,t){return s.a.createElement($e.a,Object.assign({},e,{ref:t}))})),SortArrow:Object(c.forwardRef)((function(e,t){return s.a.createElement(te.a,Object.assign({},e,{ref:t}))})),ThirdStateCheck:Object(c.forwardRef)((function(e,t){return s.a.createElement(_e.a,Object.assign({},e,{ref:t}))})),ViewColumn:Object(c.forwardRef)((function(e,t){return s.a.createElement(Qe.a,Object.assign({},e,{ref:t}))}))},Ze=a(490),et=a.n(Ze),tt=(a(466),Object(se.a)({blueBackground:{background:"linear-gradient(45deg, #3f51b5 30%, #3f51b5 90%)",border:0,borderRadius:0,boxShadow:"0 3px 5px 2px rgba(255, 105, 135, .3)",color:"white",height:48,padding:"0 30px",alignItems:"center"}}));function at(e){var t=tt(e);return s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(I.a,null,s.a.createElement(et.a,{icons:Xe,columns:[{title:"Date",field:"date",type:"date",filtering:!1,render:function(e){return be(e.date)}},{title:"Location",field:"location",filtering:!1},{title:"Type",field:"type",lookup:{DEP:"Departure",ARR:"Arrival"}}],data:e.travelChecks,title:"\ud83d\udd8b\ufe0f Travel checks list",style:{classes:t},options:{search:!1,exportButton:!0,exportAllData:!0,exportCsv:ye,localization:{exportName:"Export as Excel File"},searchFieldStyle:{backgroundColor:"#01579b",color:"#FFF"},rowStyle:function(e){return{backgroundColor:e.tableData.id%2?"#EEE":"#FFF"}}},editable:{onRowAdd:function(t){return new Promise((function(a){setTimeout((function(){e.updateTravelChecks(e.travelChecks.concat(t)),a()}),1e3)}))},onRowUpdate:function(t,a){return new Promise((function(n){setTimeout((function(){var r=e.travelChecks.concat(),o=r.indexOf(a);r[o]=t,e.updateTravelChecks(r),n()}),1e3)}))},onRowDelete:function(t){return new Promise((function(a){setTimeout((function(){var n=e.travelChecks.concat(),r=n.indexOf(t);n.splice(r,1),e.updateTravelChecks(n),a()}),1e3)}))}}})))}var nt=a(783),rt=a(258),ot=a(452),lt=a(346),it=function(e){Object(l.a)(a,e);var t=Object(i.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement(f.a,{open:this.props.showModal,onClose:this.props.hideModalHandler,"aria-labelledby":"form-dialog-title"},s.a.createElement(g.a,{id:"form-dialog-title"},"Import raw data"),s.a.createElement(nt.a,null,s.a.createElement(v.a,{container:!0},s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(y.a,{component:"p",color:"textSecondary"},"Copy and paste your travel data in the input field, select the corresponding import format and press Import.",s.a.createElement("br",null),"Nothing about you or any travel history is collected and sent anywhere: privacy is guaranteed.")),s.a.createElement(v.a,{item:!0,xs:8},s.a.createElement(rt.a,{autoFocus:!0,margin:"dense",id:"standard-multiline-flexible",label:"Paste input data here:",multiline:!0,rows:10,fullWidth:!0,name:"rawInput",size:"small",value:this.props.newRawInput,onChange:this.props.handleNewRawInput})),s.a.createElement(v.a,{item:!0,container:!0,xs:4},s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(y.a,{id:"discrete-slider-small-steps",gutterBottom:!0},"Select the import format:"),s.a.createElement(lt.a,{value:this.props.processingFunction,onChange:this.props.handleProcessingFunctionChange},s.a.createElement(ot.a,{value:"i94"},"I94 website format"),s.a.createElement(ot.a,{value:"tabular"},"Tabular copy paste format"))),s.a.createElement(v.a,{item:!0},s.a.createElement(y.a,{component:"p"},this.props.processingFunctionInfo)),s.a.createElement(v.a,{item:!0},s.a.createElement(p.a,{onClick:function(t){e.props.hideModalHandler(),e.props.handleProcessNewRawInput(t)},variant:"contained",color:"primary",size:"large"},"Import"))))),s.a.createElement(E.a,null))}}]),a}(s.a.PureComponent),ct=a(352),st=a(819),ut=a(815),dt=a(814),mt=a(496),ht=a.n(mt),pt=a(812);function ft(e){var t=s.a.useState(!1),a=Object(ct.a)(t,2),n=a[0],r=a[1],o=s.a.useState("paper"),l=Object(ct.a)(o,2)[1],i=function(e){return function(){r(!0),l(e)}};return s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(st.a,null,s.a.createElement(ut.a,{expandIcon:s.a.createElement(ht.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},s.a.createElement(y.a,{variant:"h6",color:"primary"},"How to use ?")),s.a.createElement(dt.a,null,s.a.createElement(y.a,{component:"p",color:"textPrimary"},s.a.createElement("span",{role:"img","aria-label":"tooltip-pen"},"\ud83d\udd8b\ufe0f")," Import some I94 travel history data, or manually create some entries below.",s.a.createElement("br",null),s.a.createElement("span",{role:"img","aria-label":"tooltip-calendar"},"\ud83d\udcc5")," Select a counting period",s.a.createElement("br",null),s.a.createElement("span",{role:"img","aria-label":"tooltip-graph"},"\ud83d\udcca")," Check your travel history using the timeline ",s.a.createElement("br",null),s.a.createElement("span",{role:"img","aria-label":"tooltip-calc"},"\ud83e\uddee")," Get the count of days from the results tab",s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement(p.a,{size:"small",color:"primary",variant:"contained",onClick:i("paper")},"More information")))),s.a.createElement(Et,{handleClickOpen:i,handleClose:function(){r(!1)},open:n}))}function Et(e){var t=s.a.useRef(null);return s.a.useEffect((function(){if(e.open){var a=t.current;null!==a&&a.focus()}}),[e.open]),s.a.createElement("div",null,s.a.createElement(f.a,{open:e.open,onClose:e.handleClose,scroll:e.scroll,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description"},s.a.createElement(g.a,{id:"scroll-dialog-title"},"Additional Information"),s.a.createElement(nt.a,{dividers:"paper"===e.scroll},s.a.createElement(pt.a,{id:"scroll-dialog-description",ref:t,tabIndex:-1},s.a.createElement(y.a,{variant:"h6",color:"textPrimary"},"What is this?"),s.a.createElement(y.a,{variant:"p"},"This tool has been created to help US Non Residents to fill their paperwork: the US administration sometimes require a calculation of the total amount of days spent on US territory. This can be long and difficult to do, especially if you travel a lot.",s.a.createElement("br",null),s.a.createElement("br",null),'With this tool, you can directly copy and paste your travel history in the "Import data" tool to get a visualization of your travel history, as well as the calculations needed for your paperwork on a selected time period.',s.a.createElement("br",null),s.a.createElement("br",null)),s.a.createElement(y.a,{variant:"h6",color:"textPrimary"},"What about my privacy?"),s.a.createElement(y.a,{variant:"p"},"Just like a calculator, this tool is a standalone app: it doesn't send any information you fill in on the internet.",s.a.createElement("br",null),s.a.createElement("br",null)),s.a.createElement(y.a,{variant:"h6",color:"textPrimary"},"How are days counted?"),s.a.createElement(y.a,{variant:"p"},"In most cases the US immigration counts the travel days as days ",s.a.createElement("b",null,"inside the US"),".",s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("b",null,"Example:"),s.a.createElement("br",null),"Let's say you want to count your travel days in ",s.a.createElement("b",null,"2017"),". The only trip you had was in Mexico on April 1st 2017, and you came back on April 5th 2017. ",s.a.createElement("br",null)," ",s.a.createElement("br",null),"This shows up in your I94 with the following travel checks: ",s.a.createElement("br",null)," ",Se({date:h()("2017-04-01"),location:"MIA",type:"DEP"}),"(Departure) and ",Se({date:h()("2017-04-05"),location:"MIA",type:"ARR"})," (Arrival)",s.a.createElement("br",null),s.a.createElement("br",null),"The total count of days outside the US in 2017 is 3 days: ",s.a.createElement("b",null,"you were traveling")," for 2 days ",s.a.createElement("b",null,"and outside")," the US for 3 days.",s.a.createElement("br",null),"The total count of days inside the US in 2017 is 362 days: ",s.a.createElement("b",null,"you were traveling")," for 2 days ",s.a.createElement("b",null,"and inside")," the US during 360 days.",s.a.createElement("br",null),"You may check your result with 3 + 362 = 365, there are 365 days in 2017.",s.a.createElement("br",null),s.a.createElement("br",null)),s.a.createElement(y.a,{variant:"h6",color:"textPrimary"},"Something does not work!"),s.a.createElement(y.a,{variant:"p"},"You are more than welcome to report any issue on the ",s.a.createElement("a",{href:"https://github.com/mxm-tr/travel_history_parser",rel:"noopener noreferrer",target:"_blank"},"github account of the app"),".",s.a.createElement("br",null)))),s.a.createElement(E.a,null,s.a.createElement(p.a,{onClick:e.handleClose,color:"primary"},"Close"))))}var gt={i94:s.a.createElement("span",null," Copy and paste data from the table on the",s.a.createElement("a",{href:"https://i94.cbp.dhs.gov/I94/#/history-search",target:"_blank",rel:"noopener noreferrer"}," official i94 website ")),tabular:s.a.createElement("span",null," Copy and paste data from a CSV table you have exported using this tool ")},wt=function(e){Object(l.a)(a,e);var t=Object(i.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).showModalHandler=function(){r.setState({showModal:!0})},r.hideModalHandler=function(){r.setState({showModal:!1})},r.state={showModal:!1,newTravelChecksCount:0,showImportingDataMessage:!1,showClearAllDialog:!1,showDataImportedMessage:!1,showNoDataImportedMessage:!1,travelChecks:[],newRawInput:"poop",processingFunction:"i94",dateWindowStart:new h.a,dateWindowStop:new h.a},r.handleNewRawInput=r.handleNewRawInput.bind(Object(o.a)(r)),r.handleProcessingFunctionChange=r.handleProcessingFunctionChange.bind(Object(o.a)(r)),r.handleProcessNewRawInput=r.handleProcessNewRawInput.bind(Object(o.a)(r)),r.updateTravelChecks=r.updateTravelChecks.bind(Object(o.a)(r)),r.handleWindowStartChange=r.handleWindowStartChange.bind(Object(o.a)(r)),r.handleWindowStopChange=r.handleWindowStopChange.bind(Object(o.a)(r)),r.fitDateWindow=r.fitDateWindow.bind(Object(o.a)(r)),r}return Object(r.a)(a,[{key:"handleProcessingFunctionChange",value:function(e){this.setState({processingFunction:e.target.value})}},{key:"handleNewRawInput",value:function(e){this.setState({newRawInput:e.target.value})}},{key:"handleProcessNewRawInput",value:function(e){this.setState({showImportingDataMessage:!0});var t=function(e,t){var a,n=[],r=[];switch(t){case"i94":(r=e.match(/((\S+){3})/g)).splice(r.indexOf("Date"),1),r.splice(r.indexOf("Type"),1),r.splice(r.indexOf("Location"),1);for(;r.length>0;)n.push({location:r.pop(),type:(a=r.pop(),"Departure"===a?"DEP":"Arrival"===a?"ARR":null),date:r.pop()});break;case"tabular":for((r=e.match(/[\S ]+/g).map((function(e){return e.trim()})).filter((function(e){return e.length>0}))).splice(r.indexOf("date"),1),r.splice(r.indexOf("type"),1),r.splice(r.indexOf("location"),1),r.splice(r.indexOf("tableData"),1);r.length>0;)n.push({type:r.pop(),location:r.pop(),date:r.pop()});break;default:console.error("No processing function found.")}return(n=n.filter((function(e){return("DEP"===e.type||"ARR"===e.type)&h()(e.date).isValid()}))).map((function(e){return{date:be(h()(e.date)),location:e.location,type:e.type}}))}(this.state.newRawInput,this.state.processingFunction);t.length>0?this.setState({newTravelChecksCount:t.length,showDataImportedMessage:!0}):this.setState({showNoDataImportedMessage:!0}),this.updateTravelChecks(this.state.travelChecks.concat(t)),e.preventDefault()}},{key:"fitDateWindow",value:function(){this.setState({dateWindowStart:this.state.travelChecks[0].date,dateWindowStop:this.state.travelChecks[this.state.travelChecks.length-1].date})}},{key:"handleWindowStartChange",value:function(e){this.setState({dateWindowStart:null===e?this.state.travelChecks[0].date:e}),this.updateTravels()}},{key:"handleWindowStopChange",value:function(e){this.setState({dateWindowStop:null===e?this.state.travelChecks[this.state.travelChecks.length-1].date:e}),this.updateTravels()}},{key:"updateTravelChecks",value:function(e){if(!(e.length<1)){var t=Ee(e);this.setState({dateWindowStart:t[0].date,dateWindowStop:t[t.length-1].date,travelChecks:t})}}},{key:"computeTravelsWithMessage",value:function(){return function(e,t,a){if(e.length<1)return{travels:[],message:"No travel checks yet"};var n=Ee(e).reverse(),r=[];new Date(a)>new Date(n[0].date)&&n.unshift({location:"DEP"===n[0].type?"USA":"Abroad",type:"DEP"===n[0].type?"ARR":"DEP",date:a,isAdditionalDateWindowStopCheck:!0}),new Date(t)<new Date(n[n.length-1].date)&&n.push({location:"DEP"===n[n.length-1].type?"USA":"Abroad",type:"DEP"===n[n.length-1].type?"ARR":"DEP",date:t,isAdditionalDateWindowStartCheck:!0});for(var o,l,i,c,s,u={},d=0,m=[];n.length>1;)o=n.pop(0),l=n[n.length-1],c=ve(o.date,l.date,t,a),s=ve(o.date,l.date),i="From ".concat(o.location," to ").concat(l.location,": ").concat(c," days"),s-c>0&&(i="".concat(i," (").concat(s-c," days outside selected period)")),u={id:d,type:"range",title:i,content:"From ".concat(o.location," to ").concat(l.location,": ").concat(c," days"),start:o.date,end:l.date,duration:s,durationDateWindow:c},"DEP"===o.type&&"ARR"===l.type?(d++,u.group=pe,r.push(u)):"ARR"===o.type&&"DEP"===l.type?(d++,u.group=fe,r.push(u)):m.push({travelChecks:[o,l],message:"should be consecutive Arrivals and Departures"});return{travels:r,errors:m}}(this.state.travelChecks,this.state.dateWindowStart,this.state.dateWindowStop)}},{key:"computeTravels",value:function(){return this.computeTravelsWithMessage().travels}},{key:"computeTravelsMessage",value:function(){return this.computeTravelsWithMessage().errors}},{key:"updateTravels",value:function(){var e=this.computeTravelsWithMessage();this.setState({travels:e.travels,travelsParserErrors:e.errors})}},{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",this.handleLeavePage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.handleLeavePage)}},{key:"handleLeavePage",value:function(e){var t="Do you want to leave this page? You will lose all current data.";return e.returnValue=t,t}},{key:"render",value:function(){var e=this;return s.a.createElement(S.a,null,s.a.createElement(v.a,{container:!0,justify:"center",alignItems:"center"},s.a.createElement(w.a,{open:this.state.showImportingDataMessage,onClose:function(){return e.setState({showImportingDataMessage:!1})},autoHideDuration:2e3},s.a.createElement(b.a,{color:"info"},"Importing Data")),s.a.createElement(w.a,{open:this.state.showDataImportedMessage,onClose:function(){return e.setState({showDataImportedMessage:!1})},autoHideDuration:2e3},s.a.createElement(b.a,{color:"success"},this.state.newTravelChecksCount," new lines imported !")),s.a.createElement(w.a,{open:this.state.showNoDataImportedMessage,onClose:function(){return e.setState({showNoDataImportedMessage:!1})},autoHideDuration:5e3},s.a.createElement(b.a,{color:"error"},"No data imported, check your input and make sure you selected the right processing function.")),s.a.createElement(f.a,{onClose:function(){return e.setState({showClearAllDialog:!1})},"aria-labelledby":"simple-dialog-title",open:this.state.showClearAllDialog},s.a.createElement(g.a,{id:"simple-dialog-title"},"Clear all data"),s.a.createElement(E.a,null,s.a.createElement(p.a,{onClick:function(){return e.setState({travelChecks:[],travels:[],showClearAllDialog:!1})},color:"primary"},"Delete all"),s.a.createElement(p.a,{onClick:function(){return e.setState({showClearAllDialog:!1})},color:"primary",autoFocus:!0},"Cancel"))),s.a.createElement(it,{showModal:this.state.showModal,hideModalHandler:this.hideModalHandler,handleNewRawInput:this.handleNewRawInput,handleProcessNewRawInput:this.handleProcessNewRawInput,processingFunction:this.state.processingFunction,processingFunctionInfo:gt[this.state.processingFunction],handleProcessingFunctionChange:this.handleProcessingFunctionChange}),s.a.createElement(v.a,{container:!0,item:!0,xs:11,spacing:3,direction:"row",alignItems:"center",justify:"center",style:{marginTop:10,marginBottom:10}},s.a.createElement(v.a,{container:!0,item:!0,spacing:3,justify:"center",alignItems:"flex-start"},s.a.createElement(v.a,{container:!0,item:!0,xs:7,direction:"column",spacing:2},s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(y.a,{component:"h4",variant:"h5",color:"inherit",noWrap:!0},s.a.createElement("span",{role:"img","aria-label":"airplane"},"\u2708\ufe0f")," US Travel History Calculator")),s.a.createElement(ft,null),s.a.createElement(at,{travelChecks:this.state.travelChecks,updateTravelChecks:this.updateTravelChecks}),s.a.createElement(Oe,{errors:this.computeTravelsMessage()})),s.a.createElement(v.a,{container:!0,item:!0,xs:5,direction:"column",spacing:2},s.a.createElement(v.a,{item:!0,container:!0,xs:12,justify:"space-between",alignItems:"center"},s.a.createElement(v.a,{item:!0},s.a.createElement(p.a,{onClick:this.showModalHandler,variant:"contained",color:"primary",size:"large",startIcon:s.a.createElement(W.a,null)},"Import Data")),s.a.createElement(v.a,{item:!0},s.a.createElement(p.a,{onClick:function(){return e.setState({showClearAllDialog:!0})},variant:"contained",color:"secondary",size:"large",startIcon:s.a.createElement(O.a,null)},"Clear All Data"))),s.a.createElement(L,{dateWindowStart:this.state.dateWindowStart,dateWindowStop:this.state.dateWindowStop,handleWindowStartChange:this.handleWindowStartChange,handleWindowStopChange:this.handleWindowStopChange,fitDateWindow:this.fitDateWindow}),s.a.createElement(De,{dateWindowStart:this.state.dateWindowStart,dateWindowStop:this.state.dateWindowStop,totalDaysInside:ge(this.computeTravels()),totalDaysOutside:ve(this.state.dateWindowStart,this.state.dateWindowStop)-ge(this.computeTravels()),totalDaysWindow:ve(this.state.dateWindowStart,this.state.dateWindowStop),errors:this.computeTravelsMessage()}))),s.a.createElement(v.a,{item:!0,xs:12},s.a.createElement(We,{travels:this.computeTravels(),travelChecks:this.state.travelChecks,dateWindowStart:this.state.dateWindowStart,dateWindowStop:this.state.dateWindowStop})))))}}]),a}(s.a.Component);d.a.render(s.a.createElement("div",null,s.a.createElement(wt,{name:"Travel checks list"})),document.getElementById("root"))}},[[504,1,2]]]);
//# sourceMappingURL=main.9ae9558f.chunk.js.map